<div ng-controller="ProfileCtrl as ctrl">
    <table class="maintainability-table">
        <tr>
            <td class="empty"></td>
            <td class="metric" ng-repeat="column in ctrl.columns">
                {{column.name}}
            </td>
        </tr>
        <tr ng-repeat="row in ctrl.rows">
            <td class="component">{{row.name}}</td>
            <td ng-repeat="column in ctrl.columns" class="content">
                <span ng-if="row.columns.indexOf(column.id) >= 0">
                    {{analysis.profile[column.id].rating | risk }}
                </span>
            </td>
            <td class="average content">{{ctrl.getAverage(row) | risk}}</td>
        </tr>

    </table>

    <section class="maintainability-concept">
        <h4>Timing:</h4>

        <table class="table">
            <tr>
                <td>Start:</td>
                <td>{{analysis.timing.start | date:'yyyy-MM-dd HH:mm:ss.sss'}}</td>
            </tr>
            <tr>
                <td>End:</td>
                <td>{{analysis.timing.end | date:'yyyy-MM-dd HH:mm:ss.sss'}}</td>
            </tr>
        </table>
    </section>

    <section class="maintainability-concept">
        <h4>Volume</h4>

        The volume of the program is
        <strong>{{analysis.profile.volume.size}}</strong>
    </section>

    <section class="maintainability-concept">
        <h4>Complexity per Unit</h4>

        <table class="table">
            <tr>
                <td>Low</td>
                <td>
                    <span data-lines-percentage data-src="analysis.profile.complexity_per_unit.low" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
            <tr>
                <td>Moderate</td>
                <td>
                <span data-lines-percentage data-src="analysis.profile.complexity_per_unit.moderate" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
            <tr>
                <td>High</td>
                <td>
                    <span data-lines-percentage data-src="analysis.profile.complexity_per_unit.high" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
            <tr>
                <td>Very High</td>
                <td>
                    <span data-lines-percentage data-src="analysis.profile.complexity_per_unit.very_high" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
        </table>
    </section>

    <section class="maintainability-concept">
        <h4>Duplication</h4>

        <p>
            Number of duplicate lines:
            <strong>{{analysis.profile.duplication.count}}</strong>
        </p>

        <p>
            Number of files containing duplicates:
            <strong>{{analysis.profile.duplication.files.length}}</strong>
        </p>
    </section>

    <section class="maintainability-concept">
        <h4>Size per Unit</h4>

        <table class="table">
            <tr>
                <td>Low</td>
                <td>
                    <span data-lines-percentage data-src="analysis.profile.unit_size.low" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
            <tr>
                <td>Moderate</td>
                <td>
                    <span data-lines-percentage data-src="analysis.profile.unit_size.moderate" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
            <tr>
                <td>High</td>
                <td>
                    <span data-lines-percentage data-src="analysis.profile.unit_size.high" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
            <tr>
                <td>Very High</td>
                <td>
                    <span data-lines-percentage data-src="analysis.profile.unit_size.very_high" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
        </table>
    </section>

    <section class="maintainability-concept">
        <h4>Unit testing</h4>

        <table class="table">
            <tr>
                <td>Test Volume</td>
                <td>
                    <span data-lines-percentage data-src="analysis.profile.unit_testing.unit_test_volume.test_volume" data-total="analysis.profile.volume.size"></span>
                </td>
            </tr>
            <tr>
                <td>Number of unit tests</td>
                <td>{{analysis.profile.unit_testing.unit_test_volume.unit_test_count}}</td>
            </tr>
        </table>

        <p>TODO: Represent these nicer:</p>


        <table class="table">
            <tbody ng-repeat="(subTitle,subProfile) in analysis.profile.unit_testing">
                <tr><th colspan="2">{{subTitle}}</th></tr>

                <tr ng-repeat="(key,value) in subProfile">
                    <td>{{key}}</td>
                    <td>{{value}}</td>
                </tr>
            </tbody>
        </table>

    </section>
</div>